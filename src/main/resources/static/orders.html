<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Artify | My Orders</title>

<link href="https://fonts.googleapis.com/css2?family=Abhaya+Libre:wght@400;500;600;700;800&family=Cinzel:wght@400..900&family=Montserrat:wght@300..900&display=swap" rel="stylesheet">
<link rel="stylesheet" href="css/base.css">

<style>
.orders-box{
  max-width:1000px;
  margin:100px auto;
  background:white;
  padding:50px;
  border-radius:20px;
  box-shadow:0 40px 90px rgba(0,0,0,.12);
}
.orders-box h2{text-align:center;margin-bottom:30px;}
.orders-table{
  width:100%;
  border-collapse:collapse;
}
.orders-table th,.orders-table td{
  padding:14px;
  border-bottom:1px solid #eee;
  text-align:left;
}
.empty{text-align:center;margin-top:40px;}
.empty button{margin-top:20px;}
</style>
</head>

<body>

<header class="site-header">
  <div class="header-row">
    <div class="brand">
      <img src="assets/logo.png" class="brand-logo">
      <span class="brand-name">ARTIFY</span>
    </div>

    <nav class="main-nav">
      <a href="index.html">Home</a>
      <a href="about.html">About Us</a>
      <a href="catalogue.html">Catalogue</a>
      <a href="wishlist.html">Wishlist</a>
      <a href="cart.html">Cart</a>
      <a href="checkout.html">Checkout</a>
    </nav>

    <div class="auth-area" id="authArea"></div>
  </div>
  <hr class="header-line">
</header>

<div class="orders-box">
  <h2>My Orders</h2>

  <table class="orders-table" id="ordersTable" style="display:none;">
    <thead>
      <tr>
        <th>Order ID</th>
        <th>Status</th>
        <th>Total</th>
      </tr>
    </thead>
    <tbody id="orders"></tbody>
  </table>

  <div class="empty" id="empty">
    <h3>No orders yet</h3>
    <p>Start exploring amazing art.</p>
    <button onclick="window.location='catalogue.html'">Go to Catalogue</button>
  </div>
</div>

<script src="js/headerAuth.js"></script>

<script>
const token = localStorage.getItem("token");
const payload = JSON.parse(atob(token.split(".")[1]));
const userId = payload.userId;

fetch(`http://localhost:8080/api/orders/my/${userId}`,{
  headers:{ "Authorization":"Bearer "+token }
})
.then(r=>r.json())
.then(data=>{
  if(!data || data.length===0) return;

  document.getElementById("empty").style.display="none";
  document.getElementById("ordersTable").style.display="table";

  let html="";
  data.forEach(o=>{
    html+=`
      <tr>
        <td>${o.id}</td>
        <td>${o.status}</td>
        <td>RM ${o.total}</td>
      </tr>
    `;
  });

  document.getElementById("orders").innerHTML=html;
});
</script>

</body>
</html>
